<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AWS Infra Agent Bot - AG-UI Console</title>
  <link rel="stylesheet" href="/static/app.css" />
</head>

<body>
  <div class="app-shell">
    <header class="topbar">
      <div class="brand">
        <span id="brandMark" class="brand-mark">AWS Infra Agent</span>
        <span id="brandSub" class="brand-sub">Operations Console</span>
      </div>
      <div class="topbar-actions">
        <button id="awsLoginBtn" class="btn-primary">CLI Login</button>
        <button id="awsConsoleBtn" class="btn-secondary">AWS Console</button>
      </div>
    </header>

    <main class="layout">
      <aside class="left-rail">
        <section class="rail-card">
          <h3>Runtime</h3>
          <div class="control-grid">
            <label for="modelSelect">Model</label>
            <select id="modelSelect"></select>

            <label for="mcpSelect">MCP Server</label>
            <select id="mcpSelect">
              <option value="none">None</option>
              <option value="aws_terraform" selected>AWS Infrastructure (Terraform)</option>
              <option value="azure_terraform">Azure Infrastructure (Terraform)</option>
            </select>
          </div>
        </section>

        <section class="rail-card">
          <h3 id="identityTitle">AWS Identity</h3>
          <div id="awsIdentity" class="identity-badge" style="display: none;">
            <span id="awsAccount">AWS: ---</span>
          </div>
          <p id="identityHelp" class="rail-help">Use CLI Login to refresh profile credentials without leaving this console.</p>
        </section>

        <section class="rail-card">
          <h3>Quick Actions</h3>
          <div id="quickActions" class="chip-grid">
            <button type="button" class="prompt-chip" data-prompt="What can you do for me?">Capabilities</button>
            <button type="button" class="prompt-chip" data-prompt="List all AWS resources in my account">Inventory</button>
            <button type="button" class="prompt-chip" data-prompt="Start ECS deployment workflow in ap-south-1">Start ECS Flow</button>
            <button type="button" class="prompt-chip" data-prompt="Review my current ECS deployment workflow">Review ECS</button>
            <button type="button" class="prompt-chip" data-prompt="Run terraform_plan for my last project">Terraform Plan</button>
            <button type="button" class="prompt-chip" data-prompt="Show my current AWS identity and permissions">Who Am I</button>
          </div>
        </section>
      </aside>

      <section class="chat-panel">
        <div class="status-row">
          <div class="status-pill">Live Session</div>
          <div class="status-meta" id="statusMeta">Idle</div>
        </div>

        <div class="chat-stream" id="chatStream">
          <div class="message assistant">
            <div class="message-meta">Assistant</div>
            <div id="welcomeMessage" class="message-body">
              Welcome back. I can guide AWS infrastructure workflows, validate prerequisites, and execute MCP tools in real time.
            </div>
          </div>
        </div>

        <form class="composer" id="composer">
          <div class="composer-input">
            <textarea id="promptInput" rows="1" placeholder="Ask for inventory, deployment, or guided ECS flow..."></textarea>
            <button type="submit" id="sendBtn">Run</button>
          </div>
          <div class="composer-hints">
            Enter to send · Shift + Enter for newline · Streaming SSE enabled
          </div>
        </form>
      </section>

      <aside class="right-rail">
        <section class="rail-card">
          <h3>Session Telemetry</h3>
          <div class="stat-card">
            <div class="stat-label">Provider</div>
            <div class="stat-value" id="providerLabel">...</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Latency</div>
            <div class="stat-value" id="latencyLabel">--</div>
          </div>
        </section>

        <section class="rail-card">
          <h3 id="workflowTitle">Guided Workflow</h3>
          <ol id="workflowList" class="workflow-list">
            <li>Start workflow and collect requirements</li>
            <li>Validate IDs, roles, and region prerequisites</li>
            <li>Create Terraform project</li>
            <li>Run plan then apply</li>
          </ol>
        </section>

        <section class="rail-card capabilities-card">
          <h3>Capabilities</h3>
          <div id="capabilitiesContent" class="capabilities-content">
            Loading capabilities...
          </div>
        </section>
      </aside>
    </main>
  </div>

  <script src="/static/app.js"></script>
</body>

</html>
